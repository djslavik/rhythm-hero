/*! rythm-hero 20-10-2015 */
"undefined"==typeof RH&&(RH={}),RH.logManager=function(){function a(){this.logLevels={}}var b=function(a,b){this.level=a,this.name=b},c={DEBUG:new b(0,"DEBUG"),WARN:new b(1,"WARN"),ERROR:new b(2,"ERROR")},d=c.WARN.level;a.prototype={getLogger:function(a){void 0===this.logLevels[a]&&(this.logLevels[a]=d);var b=this;return{debug:function(a){this.log(c.DEBUG,a)},warn:function(){this.log(c.WARN,message)},error:function(){this.log(c.ERROR,message)},log:function(c,d){c.level>=b.logLevels[a]&&console.log("["+c.name+"] "+a+" : "+d)}}},setLogLevel:function(a,b){this.logLevels[a]=b},setAllLogLevel:function(a){var b=this;Object.keys(this.logLevels).forEach(function(c){b.logLevels[c]=a})}};var e=new a;return e}(),RH.debug=function(){RH.logManager.setAllLogLevel(0)},RH.identity=function(a){return a},function(){var a=(new Date).getTime();RH.getTime=function(){return(new Date).getTime()-a}}(),RH.binarySearch=function(a,b){for(var c=0,d=a.length-1;d>=c;){var e=(c+d)/2|0,f=a[e];if(b>f)c=e+1;else{if(!(f>b))return e;d=e-=1}}return d},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),RH.EventManager=function(){function a(a){this.keyPressed=[],this.isPressed=!1,this.keyChanged=[],this.getTime=void 0===a?RH.getTime:a}var b=RH.logManager.getLogger("EventManager");return a.prototype={replay:function(a,b){var c=RH.binarySearch(this.keyChanged,a),d=c%2===0,e=function(a,c){b(d,c-a),d=!d};e(a,this.keyChanged[c+1]);for(var f=c+2;f<this.keyChanged.length;f++)e(this.keyChanged[f-1],this.keyChanged[f]);e(this.keyChanged[this.keyChanged.length-1],this.getTime())},onUp:function(a){b.debug("onUp: "+a.which),this.keyPressed[a.which]=!1,this._update()},onDown:function(a){b.debug("onDown: "+a.which),this.keyPressed[a.which]=!0,this._update()},_update:function(){var a=this.keyPressed.some(RH.identity);a!==this.isPressed&&this.keyChanged.push(this.getTime()),this.isPressed=a}},a}(),RH.TimeSignature=function(){function a(a,b){this.numerator=a,this.denumerator=b}return a.prototype={toString:function(){return numerator+"/"+denumerator},beatPerBar:function(){return 4*numerator/denumerator}},a}(),RH.TS={FOUR_FOUR:new RH.TimeSignature(4,4)},RH.GameOptions=function(){function a(a,b){this.timeSignature=a,this.tempo=b}return a.prototype={},a}(),RH.GameScreen=function(){function a(a){this.canva=a}return a.prototype={update:function(a){}},a}(),RH.Game=function(){function a(a,b,c){this.eventManager=a,this.canva=b,this.options=c,this.isOn=!0,this.t0=RH.getTime()}return a.prototype={update:function(){}},a}(),RH.Application=function(){function a(a){this.canvas=a,this.eventManager=new c}var b=RH.Game,c=RH.EventManager;return a.prototype={getEventManager:function(){return this.eventManager},start:function(){var a=new b(this.eventManager,this.canvas);!function c(){a.update(),a.isOn()&&requestAnimFrame(c)}()}},a}(),$(document).ready(function(){var a=$("canvas"),b=new RH.Application(a[0]),c=function(a){b.getEventManager().onDown(a),a.preventDefault()},d=function(a){b.getEventManager().onUp(a),a.preventDefault()};a.mousedown(c).mouseup(d),$("body").keydown(c).keyup(d)});